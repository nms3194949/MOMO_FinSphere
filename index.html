<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

  <title>MOMOè²¡å•†æ™ºåº«ï½œæœˆé…æ¯ Ã— AIæ™ºèƒ½æ±ºç­–ç³»çµ±</title>
  <meta name="description" content="MOMOè²¡å•†æ™ºåº«ï¼šæœˆé…æ¯ Ã— è³‡ç”¢å¢å€¼ Ã— AIæ™ºèƒ½æ±ºç­–ã€‚æ•´åˆåŸºé‡‘ç ”ç©¶ã€å›æ’¤ç­–ç•¥ã€è™›æ“¬è²¨å¹£é€²å‡ºå ´ã€æ¬Šè­‰ç¯©é¸èˆ‡æ™ºèƒ½å·¥å…·çš„ä¸€ç«™å¼è²¡å•†ç³»çµ±ã€‚">
  <meta name="keywords" content="MOMOè²¡å•†æ™ºåº«,MOMO FinSphere,æœˆé…æ¯,åŸºé‡‘ç ”ç©¶,åŸºé‡‘é…æ¯,å›æ’¤ç­–ç•¥,AIæ™ºèƒ½æ±ºç­–,æ¬Šè­‰ç¯©é¸,åŠ å¯†è²¨å¹£ç­–ç•¥,æŠ•è³‡å·¥å…·">
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://nms3194949.github.io/MOMO_FinSphere/">

  <meta property="og:title" content="MOMOè²¡å•†æ™ºåº«ï½œæœˆé…æ¯ Ã— AIæ™ºèƒ½æ±ºç­–ç³»çµ±">
  <meta property="og:description" content="åŸºé‡‘ç ”ç©¶ã€å›æ’¤ç­–ç•¥ã€æ¬Šè­‰ç¯©é¸èˆ‡æ™ºèƒ½å·¥å…·ä¸€ç«™å®Œæˆã€‚MOMOè²¡å•†æ™ºåº«æ‰“é€ çš„æœˆé…æ¯ Ã— AIæ™ºèƒ½æ±ºç­–å¹³å°ã€‚">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nms3194949.github.io/MOMO_FinSphere/">
  <meta property="og:image" content="https://nms3194949.github.io/MOMO_FinSphere/og-cover.jpg">
  <meta property="og:locale" content="zh_TW">

  <meta name="theme-color" content="#0A1221" />

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <style>
  :root{
    --deep:#0A1221; --card:#0C152A; --ink:#EDEFF5; --muted:#AAB2BF;
    --gold:#C9A227; --gold-soft:#E9D18A; --line:rgba(233,209,138,.28);
    --gold-grad:linear-gradient(90deg,#F9E27C 0%,#D9B84B 50%,#B88A1E 100%);
    --accent:#2D7A77;
    --danger: #ff6b6b; --safe: #3dd68c;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{background:var(--deep);color:var(--ink);font-family:"Noto Sans TC",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{color:inherit;text-decoration:none}

  .wrap{max-width:1120px;margin:0 auto;padding:16px}
  .header{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
  .logo{display:flex;align-items:center;gap:10px;font-weight:800}
  .logo::before{content:"";width:28px;height:28px;border-radius:50%;
    background:radial-gradient(120% 120% at 20% 20%, var(--gold) 0%, var(--gold-soft) 45%, transparent 46%), #1a1f2b;
    border:1px solid var(--line)}
  .nav{display:flex;gap:10px;flex-wrap:nowrap;overflow:auto;padding-bottom:4px;scroll-snap-type:x mandatory}
  .nav a{padding:10px 14px;border-radius:999px;border:1px solid var(--line);background:linear-gradient(180deg,#0e172b,#111a2f);font-weight:600;scroll-snap-align:start;flex:0 0 auto}
  .nav a[aria-current="page"], .nav a:hover{background:var(--gold-grad);color:#0A1221}

  .section{margin-top:24px}
  
  .card, .card2, .tool-card, .panel, .factor-card {
    background:var(--card);
    border:1px solid var(--line);
    border-radius:16px;
    padding:16px;
    position: relative;
    overflow: hidden; 
    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.3s ease, border-color 0.3s ease;
  }
  .card:hover, .card2:hover, .tool-card:hover, .panel:hover, .factor-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(201, 162, 39, 0.15);
    border-color: rgba(233, 209, 138, 0.6);
  }
  
  .btn{display:inline-block;padding:10px 16px;border-radius:10px;font-weight:600;transition:.2s}
  .btn-gold{background:var(--gold-grad);color:#0A1221;border:none}
  .btn-gold:hover{filter:brightness(1.1)}
  .footer{margin-top:40px;color:var(--muted);font-size:13px;text-align:center;border-top:1px solid var(--line);padding:20px 0}

  .hero{border:1px solid var(--line);border-radius:16px;padding:24px;
    background:linear-gradient(120deg,rgba(201,162,39,.15),rgba(45,122,119,.12) 40%, transparent 100%), #0B1222;text-align:center}
  .hero h1{margin:6px 0 8px;font-size:clamp(22px, 2.6vw, 32px);background:var(--gold-grad);-webkit-background-clip:text;color:transparent}
  .hero p{color:var(--muted);margin:0}
  .hero small{color:var(--gold-soft)}
  
  @keyframes pulse-gold-glow {
    0% { box-shadow: 0 0 0 0 rgba(201, 162, 39, 0.7); transform: scale(1); }
    70% { box-shadow: 0 0 0 15px rgba(201, 162, 39, 0); transform: scale(1.02); }
    100% { box-shadow: 0 0 0 0 rgba(201, 162, 39, 0); transform: scale(1); }
  }
  .hero .btn-line{
    display:inline-block;margin-top:18px;padding:12px 20px;border-radius:999px;font-weight:800;
    background:var(--gold-grad);color:#0A1221;border:none;
    box-shadow:0 6px 14px rgba(0,0,0,.35);
    transition:filter .2s;
    animation: pulse-gold-glow 2s infinite;
    position: relative; z-index: 1;
  }
  .hero .btn-line:hover{filter:brightness(1.15); animation: none; transform: scale(1.05);}

  /* --- MCS æˆ°æƒ…ä¸­å¿ƒæ¨£å¼ (Hero Section) --- */
  .mcs-hero-section {
    margin-bottom: 24px;
    border-radius: 20px;
    background: radial-gradient(circle at top right, #1e293b 0%, #0f172a 60%, #020617 100%);
    border: 1px solid rgba(201, 162, 39, 0.25);
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    overflow: hidden;
    position: relative;
  }
  .mcs-hero-section::before {
    content:""; position:absolute; top:0; left:0; right:0; height:1px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    opacity: 0.6;
  }
  .mcs-hero-inner { display: flex; align-items: stretch; gap: 30px; padding: 24px; }
  
  .hero-gauge-col {
    flex: 0 0 180px;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    border-right: 1px solid rgba(255,255,255,0.08); padding-right: 20px;
  }
  .gauge-container { position: relative; width: 140px; height: 140px; }
  .gauge-overlay {
    position: absolute; inset: 0;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    pointer-events: none;
  }
  .gauge-val { font-size: 32px; font-weight: 800; line-height: 1; color: #fff; text-shadow: 0 0 15px rgba(201,162,39,0.3); }
  .gauge-lbl { font-size: 10px; color: var(--muted); margin-top: 4px; letter-spacing: 1px; font-weight: 600; }
  .hero-meta-row {
    margin-top: 16px; font-size: 11px; color: var(--muted);
    display: flex; flex-direction: column; align-items: center; gap: 4px;
  }
  .source-tag { background: rgba(255,255,255,0.08); padding: 2px 6px; border-radius: 4px; font-size: 10px; letter-spacing: 0.5px; transition: all 0.3s; }

  .hero-info-col { flex: 1; display: flex; flex-direction: column; justify-content: center; gap: 14px; }
  .status-group { display: flex; flex-direction: column; gap: 6px; }
  .stage-badge {
    align-self: flex-start; padding: 4px 12px; border-radius: 99px;
    font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
    background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;
  }
  .stage-badge.growth { background: rgba(34,197,94,0.15); border-color: rgba(34,197,94,0.5); color: #4ade80; }
  .stage-badge.recession { background: rgba(248,113,113,0.15); border-color: rgba(248,113,113,0.5); color: #f87171; }
  .stage-badge.slowdown { background: rgba(251,146,60,0.15); border-color: rgba(251,146,60,0.5); color: #fb923c; }
  .stage-badge.heat { background: rgba(234,179,8,0.15); border-color: rgba(234,179,8,0.5); color: #facc15; }
  .stage-title { margin: 0; font-size: 18px; font-weight: 700; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
  .stage-desc { margin: 0; font-size: 13px; color: #cbd5e1; line-height: 1.5; opacity: 0.9; }
  .hero-divider { height: 1px; background: rgba(255,255,255,0.1); width: 100%; }

  .ai-insight-box {
    background: rgba(0, 0, 0, 0.2); border-left: 3px solid var(--gold);
    padding: 10px 16px; border-radius: 0 8px 8px 0;
  }
  .ai-label { font-size: 12px; color: var(--gold); font-weight: 700; margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
  .ai-label .icon { animation: pulse 2s infinite; }
  .ai-content { font-size: 13px; line-height: 1.6; color: #e2e8f0; }
  .highlight { color: var(--gold); font-weight: 600; }
  .warn { color: var(--danger); font-weight: 600; }
  @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }

  @media (max-width: 700px) {
    .mcs-hero-inner { flex-direction: column; align-items: center; text-align: center; gap: 24px; }
    .hero-gauge-col { border-right: none; border-bottom: 1px solid rgba(255,255,255,0.1); padding-right: 0; padding-bottom: 24px; width: 100%; }
    .hero-info-col { width: 100%; }
    .stage-badge { align-self: center; }
    .ai-insight-box { text-align: left; }
  }
  
  /* é€šç”¨ Grid */
  .tools{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
  #ig-section{margin-top:60px;padding:40px 0;background:#0A1221}
  #ig-section h2{font-size:22px;font-weight:700;margin:0 0 18px 0;color:var(--gold-soft)}
  .embedsocial-hashtag{border:1px solid rgba(201,162,39,0.2);border-radius:18px;background:#0C152A;box-shadow:0 6px 18px rgba(0,0,0,.35);padding:18px;min-height:420px;display:grid;place-items:center}
  @media(max-width:768px){.embedsocial-hashtag{padding:10px}}

  #strategy .bar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  #strategy .bar-title{
    font-size:16px;font-weight:800;letter-spacing:.5px;margin:0;padding-bottom:6px;
    border-bottom:1px solid var(--gold-soft);
    background:linear-gradient(90deg,#F9E27C 0%,#D9B84B 25%,#B88A1E 50%,#D9B84B 75%,#F9E27C 100%);
    background-size:200% auto; -webkit-background-clip:text; color:transparent;
    animation:goldflow 3s linear infinite;
    will-change: background-position; 
  }
  @keyframes goldflow{0%{background-position:0% 50%}100%{background-position:200% 50%}}

  #strategy .row{display:flex;gap:16px;flex-wrap:wrap}
  .card2{
    width:calc(50% - 8px);min-width:300px;
    display:flex;flex-direction:column;gap:18px;
    box-shadow:0 10px 22px rgba(0,0,0,.45);
  }
  .card2 h3{margin:0 0 4px;font-size:20px;color:var(--gold-soft)}
  .block{display:flex;flex-direction:column;gap:6px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.08)}
  .block:last-child{padding-bottom:0;border-bottom:0}
  .block .label{font-size:13.5px;font-weight:800;color:rgba(233,209,138,.9)}
  .gauge{width:100%}
  
  .gauge-bar {
    transition: width 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    will-change: width;
  }

  .readout{align-self:center;font-size:17px;font-weight:800;border:1px solid var(--gold-soft);border-radius:4px;padding:3px 10px;color:var(--ink)}
  .tick-label{font-size:9.5px;font-weight:700;fill:var(--ink)}

  @keyframes breatheGoldWhite{0%{stop-color:#FFFFFF;stop-opacity:.9}50%{stop-color:#E9D18A;stop-opacity:.82}100%{stop-color:#FFFFFF;stop-opacity:.9}}
  .gradient-stop-animated{animation:breatheGoldWhite 2.0s ease-in-out infinite alternate}

  @media(max-width:820px){.card2{width:100%}}
  @media (prefers-reduced-motion: reduce){.gradient-stop-animated{animation:none}}

  .cta-fixed{position:fixed;left:0;right:0;bottom:0;z-index:1000;background:rgba(10,18,33,.92);backdrop-filter:blur(8px);border-top:1px solid var(--line);padding:12px env(safe-area-inset-right) calc(12px + env(safe-area-inset-bottom)) env(safe-area-inset-left);display:none}
  .cta-fixed .btn-line{
    display:block;text-align:center;padding:14px 18px;border-radius:999px;background:var(--gold-grad);color:#0A1221;font-weight:800;box-shadow:0 8px 16px rgba(0,0,0,.35);
    animation: pulse-gold-glow 2s infinite;
  }
  @media(max-width:768px){
    .cta-fixed{display:block} 
    body.has-cta{padding-bottom:84px}
  }

  #calc .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
  #calc h2{margin:0 0 6px;font-size:18px;color:var(--gold-soft)}
  #calc p.desc{margin:0 0 12px;color:var(--muted)}
  #calc label{display:block;font-weight:800;font-size:13px;color:rgba(233,209,138,.9);margin-bottom:6px}
  #calc input[type="number"]{width:100%;background:#0e162a;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:10px 12px;font-size:16px}
  #calc .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  #calc input[type="range"]{width:100%}
  #calc .out{display:flex;flex-direction:column;gap:8px}
  #calc .out .kv{display:flex;align-items:center;justify-content:space-between;border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:#0b1427}
  #calc .out .k{font-size:13px;color:rgba(233,209,138,.9);font-weight:800}
  #calc .out .v{font-size:18px;font-weight:800}
  #calc .mini{font-size:12px;color:var(--muted)}
  #calc .pill{border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;color:var(--muted);cursor:pointer}
  #calc .out-row{display:flex;gap:10px;flex-wrap:wrap}
  #calc .out-row .kv{flex:1;min-width:240px}
  #calc .actions{position:absolute;top:16px;right:16px;display:flex;gap:8px}
  .btn-outline{background:transparent;border:1px solid var(--gold-soft);color:var(--gold-soft);padding:6px 10px;border-radius:10px; cursor:pointer; transition:.2s;}
  .btn-outline:hover{background:rgba(233,209,138,.08)}

  .strategy-group{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
  .strategy-btn{border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;background:#0e162a;color:var(--muted);cursor:pointer}
  .strategy-btn.is-active{background:var(--gold-grad);border-color:transparent;color:#0A1221}

  .goldCycle{
    background:linear-gradient(90deg,#F9E27C 0%,#D9B84B 40%,#B88A1E 70%,#F9E27C 100%);
    background-size:220% auto; -webkit-background-clip:text; color:transparent;
    animation:goldSweep 1.8s linear infinite;
  }
  @keyframes goldSweep{0%{background-position:0% 50%}100%{background-position:220% 50%}}
  .goldPlain{background:none !important;-webkit-background-clip:border-box !important;color:var(--gold-soft) !important;}

  .tool-card{display:flex;flex-direction:column;gap:10px;box-shadow:0 8px 18px rgba(0,0,0,.45)}
  .tool-pill-row{display:flex;gap:8px;margin-bottom:4px}
  .tool-pill{display:inline-flex;align-items:center;padding:4px 10px;border-radius:999px;border:1px solid rgba(233,209,138,.45);font-size:11px;color:var(--gold-soft)}
  .tool-title{font-size:18px;margin:0}
  .tool-desc{margin:0;color:var(--muted);font-size:14px;line-height:1.5}
  .tool-footer{margin-top:8px}

  /* æ²å‹•æ¼¸é¡¯ */
  .fade-in-section {
    opacity: 0; transform: translateY(30px);
    transition: opacity 0.8s cubic-bezier(0.25, 1, 0.5, 1), transform 0.8s cubic-bezier(0.25, 1, 0.5, 1);
    will-change: opacity, transform;
  }
  .fade-in-section.visible { opacity: 1; transform: translateY(0); }

  /* æ‡¸æµ® LINE æŒ‰éˆ• */
  .float-line-btn {
    position: fixed; bottom: 24px; right: 24px; z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    width: 60px; height: 60px; border-radius: 50%;
    background: #06C755; box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    animation: float-shake 5s infinite;
  }
  .float-line-btn:hover { transform: scale(1.1) rotate(-5deg); filter: brightness(1.1); }
  .notification-dot {
    position: absolute; top: -2px; right: -2px;
    background: #FF3B30; color: white; font-size: 12px; font-weight: bold;
    width: 22px; height: 22px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center; border: 2px solid #0A1221;
  }
  .chat-tooltip {
    position: absolute; right: 75px; background: white; color: #0A1221;
    padding: 8px 12px; border-radius: 8px; font-size: 13px; font-weight: 800;
    white-space: nowrap; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    opacity: 0; transform: translateX(10px);
    animation: fade-in-tooltip 0.5s forwards 1.5s; pointer-events: none;
  }
  .chat-tooltip::after {
    content: ""; position: absolute; right: -6px; top: 50%; transform: translateY(-50%);
    border-width: 6px 0 6px 8px; border-style: solid; border-color: transparent transparent transparent white;
  }
  @keyframes float-shake {
    0%, 80% { transform: rotate(0); }
    85% { transform: rotate(-15deg); }
    90% { transform: rotate(10deg); }
    95% { transform: rotate(-5deg); }
    100% { transform: rotate(0); }
  }
  @keyframes fade-in-tooltip { to { opacity: 1; transform: translateX(0); } }
  @media(max-width: 768px) { .float-line-btn { bottom: 90px; right: 16px; width: 54px; height: 54px; } }
  
  /* FAQ æ¨£å¼ (SEOå€å¡Š) */
  details { margin-bottom:10px; background:rgba(255,255,255,0.03); border-radius:10px; overflow:hidden; transition:background .2s; }
  details:hover { background:rgba(255,255,255,0.05); }
  summary { font-weight:bold; padding:14px; color:var(--ink); cursor:pointer; list-style:none; display:flex; align-items:center; justify-content:space-between; }
  summary::after { content:"+"; color:var(--gold-soft); font-weight:800; font-size:18px; }
  details[open] summary::after { content:"-"; }
  .faq-content { padding:0 14px 14px; color:var(--muted); line-height:1.6; font-size:14px; }
  </style>
</head>
<body>

  <main id="main" class="wrap" role="main">
    <header class="header fade-in-section" role="banner">
      <div class="logo">MOMOè²¡å•†æ™ºåº«</div>
      <nav class="nav" role="navigation" aria-label="ä¸»é¸å–®">
        <a href="#" aria-current="page">é¦–é </a>
        <a href="#mcs-dashboard">æ™¯æ°£æˆ°æƒ…</a>
        <a href="#strategy">ç­–ç•¥é€²åº¦</a>
        <a href="#calc">äº’å‹•è©¦ç®—</a>
        <a href="#tools">æ™ºèƒ½å·¥å…·</a>
        <a href="#ig-section">IG ç²¾é¸</a>
      </nav>
    </header>

    <section class="hero fade-in-section" aria-labelledby="hero-title">
      <small>é›™è´ç­–ç•¥å“ç‰Œä¸­å¿ƒ</small>
      <h1 id="hero-title">MOMOè²¡å•†æ™ºåº«ï½œæœˆé…æ¯ Ã— AIæ™ºèƒ½æ±ºç­–ç³»çµ±</h1>
      <p>æ•´åˆåŸºé‡‘æ™ºèƒ½åˆ†æã€è™›æ“¬è²¨å¹£ç­–ç•¥èˆ‡æ¬Šè­‰åˆ†æï¼Œæ‰“é€ å…¨æ–¹ä½è²¡å•†ç³»çµ±ã€‚</p>
      <a href="https://portaly.cc/momo_82786" target="_blank" rel="noopener noreferrer" class="btn-line" aria-label="åŠ å…¥ MOMO è²¡å•†æ™ºåº«å®˜æ–¹ LINE" title="é»æ“ŠåŠ å…¥ MOMO å®˜æ–¹ LINE é ˜å–æœˆé…æ¯ç­–ç•¥">åŠ å…¥å®˜æ–¹ LINE â–¶</a>
    </section>

    <section id="mcs-dashboard" class="section fade-in-section" aria-labelledby="mcs-title">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px">
          <h2 id="mcs-title" style="margin:0;color:var(--gold-soft)">MCS æ™¯æ°£æˆ°æƒ…ä¸­å¿ƒ</h2>
          <a href="./tools/msc-score.html" class="btn-outline" style="font-size:12px;padding:6px 12px">æŸ¥çœ‹å®Œæ•´åœ–è¡¨ â–¶</a>
      </div>

      <div class="mcs-hero-section">
        <div class="mcs-hero-inner">
          <div class="hero-gauge-col">
            <div class="gauge-container">
              <canvas id="mcsGaugeChart"></canvas>
              <div class="gauge-overlay">
                <div class="gauge-val" id="gaugeScoreText">--</div>
                <div class="gauge-lbl">MCS SCORE</div>
              </div>
            </div>
            <div class="hero-meta-row">
              <span id="mcsAsOf">æ›´æ–°ï¼š--</span>
              <span class="source-tag" id="mcsSource">SOURCE: FRED</span>
            </div>
          </div>
          <div class="hero-info-col">
            <div class="status-group">
              <div class="stage-badge" id="mcsStagePill">--</div>
              <h2 class="stage-title" id="mcsStageTitle">æ™¯æ°£è±¡é™ï¼š--</h2>
              <p class="stage-desc" id="mcsStageDesc">æ­£åœ¨è¼‰å…¥æ™¯æ°£æ•¸æ“š...</p>
            </div>
            <div class="hero-divider"></div>
            <div class="ai-insight-box">
              <div class="ai-label"><span class="icon">âœ¦</span> AI ç­–ç•¥è§€é»</div>
              <div class="ai-content" id="aiSummaryText">æ­£åœ¨é‹ç®—ç­–ç•¥å»ºè­°...</div>
            </div>
          </div>
        </div>
      </div>
      </section>
    <section id="strategy" class="section" aria-labelledby="strategy-title">
      <div class="bar-header fade-in-section"><h2 id="strategy-title" class="bar-title">MOMOã€Œé›™è´å·”å³°ã€ç­–ç•¥ï¼ˆé€²è¡Œä¸­ï¼‰</h2></div>
      <div class="row">
        <div class="card2 fade-in-section">
          <h3>è³‡ç”¢ç‹€æ³</h3>
          <div class="block" data-key="principal" data-min="0" data-max="10000000" data-step="1000000" data-unit="M">
            <div class="label">åŸºé‡‘è¦æ¨¡</div>
            <div class="gauge" id="g-principal"></div>
            <div class="readout" id="r-principal"></div>
          </div>
          <div class="block" data-key="monthly" data-min="0" data-max="200000" data-step="20000" data-unit="K">
            <div class="label">æœˆé…æ¯é‡‘é¡</div>
            <div class="gauge" id="g-monthly"></div>
            <div class="readout" id="r-monthly"></div>
          </div>
        </div>
        <div class="card2 fade-in-section">
          <h3>æ”¶ç›Šç‡</h3>
          <div class="block" data-key="dist" data-min="0" data-max="30" data-step="5" data-unit="%">
            <div class="label">é…æ¯ç‡(%)</div>
            <div class="gauge" id="g-dist"></div>
            <div class="readout" id="r-dist"></div>
          </div>
          <div class="block" data-key="annual" data-min="0" data-max="50" data-step="5" data-unit="%">
            <div class="label">é ä¼°å¹´å‡æˆé•·ç‡(%)</div>
            <div class="gauge" id="g-annual"></div>
            <div class="readout" id="r-annual"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="calc" class="section fade-in-section" aria-labelledby="calc-title">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:6px;flex-wrap:wrap;">
        <h2 id="calc-title">é…æ¯è¨±é¡˜</h2>
        <div style="display:flex;gap:8px">
            <button id="btn-share-link" class="btn-outline" type="button" aria-label="è¤‡è£½ç›®å‰è©¦ç®—é€£çµ">è¤‡è£½é€£çµ ğŸ”—</button>
            <button id="btn-save-png" class="btn-outline" type="button" aria-label="åŒ¯å‡ºç›®å‰äº’å‹•è©¦ç®—ç‚º PNG">åŒ¯å‡º PNG</button>
        </div>
      </div>
      <p class="desc">è¼¸å…¥æœ¬é‡‘ï¼Œèª¿æ•´ã€Œé…æ¯ç‡ã€æ‹‰æ¡¿ï¼Œç³»çµ±æœƒå³æ™‚è¨ˆç®—ï¼šæ¯æœˆé…æ¯ã€<strong>æ¯å¹´çš„æœ¬é‡‘æˆé•·ç‡</strong>ã€ä¸‰å¹´å¾Œæœ¬é‡‘ã€ä¸‰å¹´ç¸½é ˜é…æ¯ã€ä¸‰å¹´ç¸½å ±é…¬èˆ‡å ±é…¬ç‡ã€‚</p>

      <div class="grid" id="calc-capture">
        <div class="panel" aria-labelledby="in-title">
          <h3 id="in-title" style="margin:0 0 10px">è¼¸å…¥</h3>

          <label style="display:block;margin-bottom:6px">ç­–ç•¥é¸æ“‡</label>
          <div class="strategy-group" role="group" aria-label="ç­–ç•¥é¸æ“‡">
            <button type="button" class="strategy-btn" data-strategy="start" aria-pressed="false">é›™è´èµ·æ­¥</button>
            <button type="button" class="strategy-btn is-active" data-strategy="rise" aria-pressed="true">é›™è´èºå‡</button>
            <button type="button" class="strategy-btn" data-strategy="peak" aria-pressed="false">é›™è´å·”å³°</button>
          </div>

          <label for="amt" style="margin-top:4px">æŠ•å…¥æœ¬é‡‘ï¼ˆå…ƒï¼‰</label>
          <input id="amt" type="number" inputmode="numeric" min="0" step="1000" value="1000000" />

          <div class="row" style="margin-top:14px">
            <label for="distRange" style="margin:0">é…æ¯ç‡ï¼ˆ%ï¼‰</label>
            <span id="distNow" class="pill" aria-live="polite">8%</span>
          </div>
          <input id="distRange" type="range" min="0" max="17" step="1" value="8" aria-valuemin="0" aria-valuemax="17" aria-valuenow="8" aria-label="é…æ¯ç‡" aria-describedby="distNow"/>
          <div class="mini">ç¯„åœ 0â€“17%ï¼Œæ­¥é€² 1%ï½œå¿«æ·ï¼š
            <button type="button" id="dist5"  class="pill" aria-label="é…æ¯ç‡è¨­ç‚º5%">5%</button>
            <button type="button" id="dist10" class="pill" aria-label="é…æ¯ç‡è¨­ç‚º10%">10%</button>
            <button type="button" id="dist15" class="pill" aria-label="é…æ¯ç‡è¨­ç‚º15%">15%</button>
          </div>
        </div>

        <div class="panel" aria-labelledby="out-title">
          <h3 id="out-title" style="margin:0 0 10px">çµæœ</h3>
          <div class="out" aria-live="polite">
            <div class="kv"><div class="k">é ä¼°æœˆé…æ¯</div><div class="v" id="out-monthly">â€”</div></div>
            <div class="kv"><div class="k">æ¯å¹´æœ¬é‡‘æˆé•·ç‡</div><div class="v" id="out-grow">â€”</div></div>
            <div class="kv"><div class="k">ä¸‰å¹´å¾Œæœ¬é‡‘ï¼ˆä¸å«é…æ¯ï¼‰</div><div class="v" id="out-3y">â€”</div></div>
            <div class="kv"><div class="k">ä¸‰å¹´ç¸½é ˜é…æ¯</div><div class="v" id="out-3y-div">â€”</div></div>
            <div class="out-row">
              <div class="kv"><div class="k">ä¸‰å¹´ç¸½å ±é…¬ï¼ˆæœ¬é‡‘+é…æ¯ï¼‰</div><div class="v goldCycle" id="out-total">â€”</div></div>
              <div class="kv"><div class="k">ä¸‰å¹´ç´¯ç©å ±é…¬ç‡</div><div class="v goldCycle" id="out-total-rate">â€”</div></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section fade-in-section" id="tools" aria-labelledby="tools-title">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px">
        <h2 id="tools-title" style="margin:0;color:var(--gold-soft)">æ™ºèƒ½å·¥å…·</h2>
        <a href="./tools/" class="btn btn-gold" style="border-radius:999px;padding:10px 18px;font-size:14px">
          æŸ¥çœ‹å…¨éƒ¨å·¥å…· â–¶
        </a>
      </div>
      <div class="tools" id="home-tools-grid"></div>
    </section>

    <section id="seo-article-container" class="section fade-in-section" style="margin-bottom:20px;"></section>

    <section id="seo-faq-container" class="section fade-in-section" style="margin-bottom:40px;"></section>

    <section id="ig-section" class="fade-in-section" aria-labelledby="ig-title">
      <h2 id="ig-title">æœ€æ–° IG ç²¾é¸</h2>
      <div class="embedsocial-hashtag" data-ref="42032a17319b8cd123ca39bbcf94096c57c120b0">
        <a class="feed-powered-by-es feed-powered-by-es-feed-img es-widget-branding" href="https://embedsocial.com/social-media-aggregator/" target="_blank" title="Instagram widget">
          <img src="https://embedsocial.com/cdn/icon/embedsocial-logo.webp" alt="EmbedSocial">
          <div class="es-widget-branding-text">Instagram widget</div>
        </a>
      </div>
    </section>

    <footer class="footer">Â© MOMOè²¡å•†æ™ºåº«ï½œæŠ•è³‡æœ‰é¢¨éšªï¼ŒåŸºé‡‘èˆ‡åŠ å¯†è³‡ç”¢ç„¡ä¿è­‰å ±é…¬ï¼Œæ·¨å€¼å¯èƒ½å› å¸‚å ´æ³¢å‹•è€Œè®ŠåŒ–ï¼Œè«‹ä¾è‡ªèº«é¢¨éšªæ‰¿å—åº¦è¬¹æ…è©•ä¼°ã€‚</footer>
  </main>

  <div class="cta-fixed" role="region" aria-label="åŠ å…¥å®˜æ–¹ LINE">
    <a href="https://portaly.cc/momo_82786" target="_blank" rel="noopener noreferrer" class="btn-line" aria-label="ç«‹å³åŠ å…¥ MOMO è²¡å•†æ™ºåº«å®˜æ–¹ LINE">åŠ å…¥å®˜æ–¹ LINE â–¶</a>
  </div>

  <a href="https://portaly.cc/momo_82786" target="_blank" rel="noopener noreferrer" class="float-line-btn" aria-label="åŠ å…¥ LINE å¥½å‹" title="åŠ å…¥ LINE å¥½å‹é ˜å–é›™è´ç­–ç•¥">
    <div class="line-icon">
      <svg viewBox="0 0 24 24" fill="#FFFFFF" width="32" height="32">
        <path d="M12 2C6.48 2 2 5.58 2 10c0 2.38 1.19 4.47 3 6.16V20c0 .55.45 1 1 1 .34 0 .65-.17.84-.44L9.6 18.3c.76.22 1.56.36 2.4.36 5.52 0 10-3.58 10-8s-4.48-8-10-8z"/>
      </svg>
    </div>
    <div class="notification-dot">1</div>
    <div class="chat-tooltip">é ˜å–é›™è´ç­–ç•¥ ğŸ</div>
  </a>

  <script>
  /* ==========================================================================
     SEO èˆ‡ å…§å®¹ç¶­è­·å€
     ========================================================================== */
  const SEO_DATA = {
    faq: [
      {
        q: "MOMO é›™è´ç­–ç•¥é©åˆæ–°æ‰‹å—ï¼Ÿ",
        a: "éå¸¸é©åˆã€‚æˆ‘å€‘çš„ç­–ç•¥åŒ…å«ã€Œé›™è´èµ·æ­¥ã€æ¨¡çµ„ï¼Œå°ˆç‚ºåˆå…¥å¸‚å ´çš„æŠ•è³‡äººè¨­è¨ˆï¼Œé€éä½æ³¢å‹•çš„æœˆé…æ¯åŸºé‡‘é…ç½®ï¼Œé™ä½å¸‚å ´éœ‡ç›ªçš„å¿ƒç†å£“åŠ›ï¼ŒåŒæ™‚å»ºç«‹ç©©å®šçš„ç¾é‡‘æµã€‚"
      },
      {
        q: "é€™å€‹è©¦ç®—å·¥å…·æº–ç¢ºå—ï¼Ÿ",
        a: "æ­¤å·¥å…·åŸºæ–¼æ­·å²å›æ¸¬æ•¸æ“šèˆ‡ MOMO è²¡å•†æ™ºåº«çš„ AI æ¨¡å‹é‹ç®—ã€‚é›–ç„¶éå»ç¸¾æ•ˆä¸ä»£è¡¨æœªä¾†è¡¨ç¾ï¼Œä½†é€éã€Œå¹´å‡æˆé•·ç‡ã€èˆ‡ã€Œé…æ¯ç‡ã€çš„å‹•æ…‹è©¦ç®—ï¼Œèƒ½å¹«åŠ©æ‚¨æ›´å…·é«”åœ°è¦åŠƒé€€ä¼‘ç›®æ¨™èˆ‡ç¾é‡‘æµéœ€æ±‚ã€‚"
      },
      {
        q: "å¦‚ä½•é–‹å§‹ä½¿ç”¨ MOMO çš„è²¡å•†å·¥å…·ï¼Ÿ",
        a: "æ‚¨å¯ä»¥ç›´æ¥é»æ“Šå³ä¸‹è§’çš„ LINE æŒ‰éˆ•åŠ å…¥å®˜æ–¹å¸³è™Ÿï¼Œæˆ‘å€‘æœƒæä¾›æ‚¨å°ˆå±¬çš„é…ç½®å»ºè­°èˆ‡å·¥å…·ä½¿ç”¨æ•™å­¸ã€‚"
      }
    ],
    article: {
      title: "ç‚ºä»€éº¼éœ€è¦æœˆé…æ¯è¤‡åˆ©è©¦ç®—ï¼Ÿ",
      content: `
        åœ¨è¦åŠƒ<strong>è¢«å‹•æ”¶å…¥</strong>æ™‚ï¼Œè¨±å¤šæŠ•è³‡äººå¿½ç•¥äº†<strong>æœ¬é‡‘æˆé•·</strong>çš„é‡è¦æ€§ã€‚
        MOMO FinSphere ç³»çµ±æ•´åˆäº†<strong>åŸºé‡‘æ™ºèƒ½åˆ†æ</strong>èˆ‡<strong>åŠ å¯†è²¨å¹£ç­–ç•¥</strong>ï¼Œ
        ä¸åŒæ–¼å‚³çµ±çš„å„²è“„éšªæˆ–å®šå­˜ï¼Œæˆ‘å€‘é€é AI ç›£æ§å¸‚å ´å›æ’¤ï¼Œå”åŠ©æ‚¨åœ¨é ˜å–<strong>æœˆé…æ¯</strong>çš„åŒæ™‚ï¼Œç¢ºä¿è³‡ç”¢èƒ½æŠµæŠ—é€šè†¨ã€‚
        ç„¡è«–æ˜¯é€€ä¼‘è¦åŠƒã€ç¾é‡‘æµç®¡ç†ï¼Œé€éæœ¬ç«™çš„<strong>è¤‡åˆ©è¨ˆç®—æ©Ÿ</strong>ï¼Œæ‚¨èƒ½ä¸€éµé è¦½æœªä¾†ä¸‰å¹´çš„è³‡ç”¢è®ŠåŒ–ã€‚
      `
    },
    app: {
      name: "MOMO æœˆé…æ¯ AI è©¦ç®—å·¥å…·",
      desc: "è¼¸å…¥æœ¬é‡‘èˆ‡é æœŸé…æ¯ç‡ï¼ŒAI ç³»çµ±å³æ™‚è¨ˆç®—æ¯æœˆç¾é‡‘æµã€æœ¬é‡‘æˆé•·èˆ‡ä¸‰å¹´ç¸½å ±é…¬çš„å…è²»è²¡å•†å·¥å…·ã€‚",
      url: "https://nms3194949.github.io/MOMO_FinSphere/"
    }
  };

  function initSEO() {
    const faqContainer = document.getElementById('seo-faq-container');
    if (faqContainer && SEO_DATA.faq.length > 0) {
      let html = `<h2 style="color:var(--gold-soft); margin-bottom:16px;">å¸¸è¦‹å•é¡Œ</h2><div class="card">`;
      SEO_DATA.faq.forEach(item => {
        html += `<details><summary>${item.q}</summary><div class="faq-content">${item.a}</div></details>`;
      });
      html += `</div>`;
      faqContainer.innerHTML = html;
    }
    const articleContainer = document.getElementById('seo-article-container');
    if (articleContainer && SEO_DATA.article.content) {
      articleContainer.innerHTML = `<article style="color:var(--muted); font-size:14px; line-height:1.8;"><h3 style="color:var(--gold-soft); font-size:16px;">${SEO_DATA.article.title}</h3><p>${SEO_DATA.article.content}</p></article>`;
    }
    const faqSchema = { "@context": "https://schema.org", "@type": "FAQPage", "mainEntity": SEO_DATA.faq.map(item => ({ "@type": "Question", "name": item.q, "acceptedAnswer": { "@type": "Answer", "text": item.a } })) };
    injectJSONLD(faqSchema);
    const appSchema = { "@context": "https://schema.org", "@type": "SoftwareApplication", "name": SEO_DATA.app.name, "applicationCategory": "FinanceApplication", "operatingSystem": "Web", "offers": { "@type": "Offer", "price": "0", "priceCurrency": "TWD" }, "description": SEO_DATA.app.desc, "author": { "@type": "Person", "name": "MOMO", "url": "https://portaly.cc/momo_82786" } };
    injectJSONLD(appSchema);
  }

  function injectJSONLD(data) {
    const script = document.createElement('script'); script.type = "application/ld+json"; script.text = JSON.stringify(data); document.head.appendChild(script);
  }

  const $ =(id)=>document.getElementById(id);
  const nfTW = new Intl.NumberFormat('zh-TW');
  const clamp =(v,min,max)=>Math.min(max,Math.max(min,v));
  const money =(x)=>'ï¼„'+nfTW.format(Math.round(x));
  const pct =(x)=>(Math.round(x*100)/100).toFixed(2)+'%';
  const passiveOpt={passive:true};

  async function ensureCanvas(){
    if(!window.html2canvas){
      await new Promise((res,rej)=>{
        const s=document.createElement('script'); s.src='https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js'; s.crossOrigin='anonymous'; s.onload=res; s.onerror=()=>rej(new Error('load html2canvas failed')); document.head.appendChild(s);
      });
    }
  }

  /* === Gauge logic === */
  const MOMO_PROGRESS_CONFIG = { monthly:75658, principal:6277633, dist:14, annual:45 };
  function fmtAxis(v,u){ if(u=='%') return Math.round(v); if(u=='M') return (v/1e6).toFixed(0)+'M'; if(u=='K') return (v/1e3).toFixed(0)+'K'; return nfTW.format(v); }
  function fmtRead(v,u){ return u=='%'?Number(v).toFixed(2)+'%':'ï¼„'+nfTW.format(Math.round(v))+' å…ƒ' }
  function autoStep(min,max,baseStep,containerWidth){ const ticks=(max-min)/baseStep; if(containerWidth<320&&ticks>8) return baseStep*2; if(containerWidth<280&&ticks>6) return baseStep*3; return baseStep; }
  const uniqueId=(p='id')=>`${p}-${Math.random().toString(36).slice(2,9)}`;

  function animateValue(callback, start, end, duration) {
    let startTimestamp = null;
    const step = (timestamp) => {
      if (!startTimestamp) startTimestamp = timestamp;
      const progress = Math.min((timestamp - startTimestamp) / duration, 1);
      const easeProgress = progress === 1 ? 1 : 1 - Math.pow(2, -10 * progress);
      const currentVal = Math.floor(easeProgress * (end - start) + start);
      callback(currentVal);
      if (progress < 1) window.requestAnimationFrame(step);
    };
    window.requestAnimationFrame(step);
  }

  function createGauge(el, { min, max, step, unit, breath = false }) {
    const parentWidth = Math.max(260, el.clientWidth || 300);
    const W = parentWidth, H = 64, BH = 14, X0 = 10, WB = W - 2 * X0, Y = 42, TYO = 10, TL = 6;
    const stepUsed = autoStep(min, max, step, parentWidth);
    const valueToX = v => { const t = (clamp(v, min, max) - min) / (max - min || 1); return X0 + t * WB; };
    const NS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(NS, 'svg'); svg.setAttribute('viewBox', `0 0 ${W} ${H}`); el.innerHTML = ''; el.appendChild(svg);
    let fillAttr = '#E9D18A';
    if (breath) {
      const gradId = uniqueId('goldGrad');
      const defs = document.createElementNS(NS, 'defs');
      const g = document.createElementNS(NS, 'linearGradient'); g.setAttribute('id', gradId); g.setAttribute('x1', '0%'); g.setAttribute('y1', '0%'); g.setAttribute('x2', '100%'); g.setAttribute('y2', '0%');
      const s1 = document.createElementNS(NS, 'stop'); s1.setAttribute('offset', '0%'); s1.setAttribute('style', 'stop-color:#E9D18A;stop-opacity:1');
      const s2 = document.createElementNS(NS, 'stop'); s2.setAttribute('offset', '100%'); s2.setAttribute('class', 'gradient-stop-animated');
      g.append(s1, s2); defs.append(g); svg.append(defs); fillAttr = `url(#${gradId})`;
    }
    const lblStep = stepUsed * 2; let lastMajorX = -1e9;
    for (let v = min; v <= max; v += stepUsed) {
      const x = valueToX(v); const isMajor = (Math.abs(((v - min) % lblStep)) < 1e-6) || v === min || v === max;
      const ln = document.createElementNS(NS, 'line'); ln.setAttribute('x1', x); ln.setAttribute('y1', Y - BH / 2 - TYO); ln.setAttribute('x2', x); ln.setAttribute('y2', Y - BH / 2 - TYO + TL); ln.setAttribute('stroke', isMajor ? '#E9D18A' : 'rgba(233,209,138,.7)'); ln.setAttribute('stroke-width', isMajor ? '2.6' : '1'); svg.append(ln);
      if (isMajor && Math.abs(x - lastMajorX) > 36) {
          const t = document.createElementNS(NS, 'text'); t.setAttribute('x', x); t.setAttribute('y', Y - BH / 2 - TYO - 3); t.setAttribute('text-anchor', 'middle'); t.setAttribute('class', 'tick-label'); t.textContent = fmtAxis(v, unit); svg.append(t); lastMajorX = x;
      }
    }
    const tr = document.createElementNS(NS, 'rect'); tr.setAttribute('x', X0); tr.setAttribute('y', Y - BH / 2); tr.setAttribute('width', WB); tr.setAttribute('height', BH); tr.setAttribute('rx', BH / 2); tr.setAttribute('fill', '#1a2337'); svg.append(tr);
    const pr = document.createElementNS(NS, 'rect'); pr.setAttribute('class', 'gauge-bar'); pr.setAttribute('x', X0); pr.setAttribute('y', Y - BH / 2); pr.setAttribute('height', BH); pr.setAttribute('rx', BH / 2); pr.setAttribute('fill', fillAttr); pr.setAttribute('width', 0); svg.append(pr);
    return function updateBarWidth(val) { const currentW = Math.max(0, valueToX(val) - X0); pr.setAttribute('width', currentW); };
  }

  function mountBlock(blockEl){
    const key=blockEl.dataset.key; const min=+blockEl.dataset.min; const max=+blockEl.dataset.max; const step=+blockEl.dataset.step; const unit=blockEl.dataset.unit;
    const gaugeEl=blockEl.querySelector('.gauge'); const readEl=blockEl.querySelector('.readout');
    const initVal=clamp(Number(MOMO_PROGRESS_CONFIG[key]??0),min,max); blockEl._value=initVal;
    let updateView = null;
    const init = () => { updateView = createGauge(gaugeEl, { min, max, step, unit, value: blockEl._value, breath: (key==='monthly') }); updateView(blockEl._value); };
    init();
    if(key === 'principal' || key === 'monthly') { animateValue((val) => { readEl.textContent = fmtRead(val, unit); }, 0, initVal, 1500); } else { readEl.textContent = fmtRead(initVal, unit); }
    blockEl._update=(v)=>{ const nv=clamp(v,min,max); blockEl._value=nv; if(updateView) updateView(nv); readEl.textContent=fmtRead(nv,unit); };
    const ro=new ResizeObserver(()=>{ if(blockEl._resizeTimer) clearTimeout(blockEl._resizeTimer); blockEl._resizeTimer=setTimeout(init, 100); });
    ro.observe(gaugeEl); blockEl._destroy=()=>{ ro.disconnect(); if(blockEl._resizeTimer) clearTimeout(blockEl._resizeTimer); };
  }

  /* === Calc logic === */
  const STRATEGY = { start:12.24, rise:27.29, peak:64.22 };
  const SLOPE = 1; const MONTHLY_MULT = { start:1, rise:1, peak:2.5 };
  const state = { baseCAGR: STRATEGY.rise, monthlyMul: MONTHLY_MULT.rise, principal: 1_000_000, dist: 8 };
  function safeNum(v,def=0){ v=+v; return Number.isFinite(v)?v:def; }
  function compute({principal, dist, baseCAGR, monthlyMul}){
    const monthlyBase = principal*(dist/100)/12; const monthly = monthlyBase * (monthlyMul ?? 1);
    const grow = Math.max(0, baseCAGR - SLOPE*dist); const after3y = principal*Math.pow(1+grow/100,3);
    const div3y = principal*(dist/100)*3 * (monthlyMul ?? 1); const total = after3y + div3y;
    const totalRate = principal>0 ? (total/principal - 1)*100 : 0; return { monthly, grow, after3y, div3y, total, totalRate };
  }
  function renderOutputs(o){ $('out-monthly').textContent = money(o.monthly); $('out-grow').textContent = pct(o.grow); $('out-3y').textContent = money(o.after3y); $('out-3y-div').textContent = money(o.div3y); $('out-total').textContent = money(o.total); $('out-total-rate').textContent = pct(o.totalRate); }
  function persist(){ try{ localStorage.setItem('momo-calc', JSON.stringify(state)); }catch(_){} }
  function restore(){ try{ const s = JSON.parse(localStorage.getItem('momo-calc')); if(s && typeof s==='object'){ if(typeof s.baseCAGR==='number') state.baseCAGR=s.baseCAGR; if(typeof s.monthlyMul==='number') state.monthlyMul=s.monthlyMul; if(typeof s.principal==='number') state.principal=s.principal; if(typeof s.dist==='number') state.dist=s.dist; } }catch(_){} }
  
  function fromURL(){
    const p=new URLSearchParams(location.search);
    if(p.has('principal')) state.principal=clamp(safeNum(p.get('principal'), state.principal), 0, 1e9);
    if(p.has('dist')) state.dist=clamp(safeNum(p.get('dist'), state.dist), 0, 100);
    const st=p.get('strategy');
    if(st && ['start','rise','peak'].includes(st)){
      state.baseCAGR = STRATEGY[st]; state.monthlyMul = MONTHLY_MULT[st];
      document.querySelectorAll('[data-strategy]').forEach(b=>{ const active = b.dataset.strategy===st; b.classList.toggle('is-active', active); b.setAttribute('aria-pressed', active?'true':'false'); });
    }
  }

  function update(){
    const badge = $('distNow'); if(badge) badge.textContent = (state.dist||0) + '%';
    const amt=$('amt'), range=$('distRange');
    if(amt) amt.value = safeNum(state.principal,0); if(range){ range.value = safeNum(state.dist,0); range.setAttribute('aria-valuenow', range.value); }
    renderOutputs(compute(state)); persist();
  }

  function bindEvents(){
    const r = $('distRange'); r.addEventListener('input', ()=>{ state.dist = safeNum(r.value,0); update(); }, passiveOpt); r.addEventListener('change', ()=>{ state.dist = safeNum(r.value,0); update(); }, passiveOpt);
    [['dist5',5],['dist10',10],['dist15',15]].forEach(([id,v])=>{ $(id)?.addEventListener('click', ()=>{ state.dist=v; r.value=v; update(); }, passiveOpt); });
    const a = $('amt'); a.addEventListener('input', ()=>{ const raw=safeNum(a.value,0); state.principal=clamp(raw,0,1_000_000_000); a.value=state.principal; update(); }, passiveOpt); a.addEventListener('change', ()=>{ const raw=safeNum(a.value,0); state.principal=clamp(raw,0,1_000_000_000); a.value=state.principal; update(); }, passiveOpt);
    document.querySelectorAll('[data-strategy]').forEach(btn=>{ btn.addEventListener('click', ()=>{ const key = btn.getAttribute('data-strategy'); state.baseCAGR = STRATEGY[key] ?? state.baseCAGR; state.monthlyMul = MONTHLY_MULT[key] ?? 1; document.querySelectorAll('[data-strategy]').forEach(b=>{ b.classList.remove('is-active'); b.setAttribute('aria-pressed','false'); }); btn.classList.add('is-active'); btn.setAttribute('aria-pressed','true'); update(); }, passiveOpt); });

    const btn = $('btn-save-png'); const target = $('calc-capture');
    if(btn && target){
      btn.addEventListener('click', async ()=>{
        const prev = {boxShadow: target.style.boxShadow, padding: target.style.padding, bg: target.style.background, transform: target.style.transform}; target.style.transform = 'none';
        const goldEls = Array.from(document.querySelectorAll('.goldCycle')); const prevClasses = goldEls.map(el => el.className); goldEls.forEach(el => { el.classList.add('goldPlain'); });
        target.style.boxShadow='0 0 0 1px rgba(233,209,138,.18)'; target.style.padding='8px'; target.style.background='transparent';
        try{ await ensureCanvas(); const canvas = await html2canvas(target,{ backgroundColor:'#0A1221', scale: Math.min(2, window.devicePixelRatio || 1), useCORS:true, logging:false }); canvas.toBlob(blob=>{ if(blob){ const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download=`MOMO_calc_${new Date().toISOString().replace(/[:T]/g,'-').slice(0,19)}.png`; document.body.appendChild(a); a.click(); setTimeout(()=>{ URL.revokeObjectURL(url); a.remove(); }, 250); } }); }catch(e){ alert('åŒ¯å‡ºå¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡'); }
        finally{ target.style.boxShadow=prev.boxShadow; target.style.padding=prev.padding; target.style.background=prev.bg; target.style.transform=prev.transform; const goldNow = Array.from(document.querySelectorAll('.goldPlain')); goldNow.forEach((el,idx) => { el.className = prevClasses[idx] || el.className.replace(' goldPlain',''); }); }
      }, passiveOpt);
    }

    const btnShare = $('btn-share-link');
    if(btnShare){
      btnShare.addEventListener('click', async () => {
        const params = new URLSearchParams();
        params.set('principal', state.principal);
        params.set('dist', state.dist);
        const activeStrategyBtn = document.querySelector('.strategy-btn.is-active');
        if(activeStrategyBtn) { params.set('strategy', activeStrategyBtn.dataset.strategy); }
        const shareUrl = `${window.location.origin}${window.location.pathname}?${params.toString()}`;
        try { await navigator.clipboard.writeText(shareUrl); const originalText = btnShare.textContent; btnShare.textContent = "å·²è¤‡è£½ï¼âœ…"; btnShare.style.borderColor = "#06C755"; btnShare.style.color = "#06C755"; setTimeout(() => { btnShare.textContent = originalText; btnShare.style.borderColor = ""; btnShare.style.color = ""; }, 2000); } catch (err) { alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ç¶²å€'); }
      }, passiveOpt);
    }

    if (matchMedia('(max-width: 768px)').matches) document.body.classList.add('has-cta');
    const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); } }); }, { threshold: 0.1 }); document.querySelectorAll('.fade-in-section').forEach(el => observer.observe(el));
    const igSection = document.getElementById('ig-section');
    const loadIgScript = () => { if(window.igScriptLoaded) return; var js = document.createElement("script"); js.src = "https://embedsocial.com/cdn/ht.js"; js.id = "EmbedSocialHashtagScript"; document.head.appendChild(js); window.igScriptLoaded = true; };
    const igObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { loadIgScript(); igObserver.disconnect(); } }); }, { rootMargin: "200px" }); if(igSection) igObserver.observe(igSection);
  }

  /* =========================================
     MCS å„€è¡¨æ¿é‚è¼¯ (é¦–é ç²¾ç°¡ç‰ˆ)
     ========================================= */
  const API_BASE = 'https://mcs-worker.nms3194949.workers.dev';
  let gaugeChart = null;

  function setStagePill(stage) {
    const pill = document.getElementById('mcsStagePill');
    const titleEl = document.getElementById('mcsStageTitle');
    const descEl  = document.getElementById('mcsStageDesc');
    if(!pill) return;

    const mapTitle = { Recession:'Recession (è¡°é€€å€)', Slowdown:'Slowdown (æ”¾ç·©å€)', Growth:'Growth (æˆé•·å€)', Heat:'Heat (éç†±å€)' };
    const mapDesc = { Recession:'é¢¨éšªåå¥½ä¸‹é™ï¼Œä¿¡ç”¨åˆ©å·®æ”¾å¤§ã€‚è³‡ç”¢é…ç½®å»ºè­°ä»¥ã€Œé˜²ç¦¦èˆ‡ç¾é‡‘ç®¡ç†ã€ç‚ºä¸»ï¼Œç­‰å¾…è½åº•è¨Šè™Ÿã€‚', Slowdown:'æˆé•·å‹•èƒ½æ”¾ç·©ä½†æœªå…¨é¢è¡°é€€ã€‚å»ºè­°ä¿å®ˆèª¿æ•´é«˜æ³¢å‹•éƒ¨ä½ï¼Œé—œæ³¨é«˜å“è³ªæ”¶ç›Šè³‡ç”¢ã€‚', Growth:'ç¶“æ¿Ÿèˆ‡ä¼æ¥­ç²åˆ©ç¶­æŒæˆé•·ã€‚é©åˆæ ¸å¿ƒé•·æœŸæŒæœ‰ï¼Œä¸¦æ–¼å›æª”æ™‚å¸ƒå±€æˆé•·å‹è³‡ç”¢ã€‚', Heat:'å¸‚å ´æƒ…ç·’åç†±ï¼Œéœ€æ³¨æ„ä¼°å€¼èˆ‡é¢¨éšªç´¯ç©ã€‚å»ºè­°é©åº¦åœåˆ©ï¼Œä¿ç•™ç¾é‡‘å½ˆæ€§ã€‚' };

    pill.classList.remove('recession','slowdown','growth','heat');
    if (!stage) {
      pill.textContent = '--'; titleEl.textContent = 'æ™¯æ°£è±¡é™ï¼š--'; descEl.textContent = 'æ­£åœ¨è®€å– MCS æ™¯æ°£æ•¸æ“š...';
      return;
    }
    pill.classList.add(stage.toLowerCase());
    pill.textContent = stage;
    titleEl.textContent = mapTitle[stage] || ('Stage: ' + stage);
    descEl.textContent  = mapDesc[stage]  || 'ä¾ MCS åˆ†æ•¸å°æ‡‰å››å¤§æ™¯æ°£å€é–“ã€‚';
  }

  function updateAiSummary(data) {
    const el = document.getElementById('aiSummaryText');
    if (!el || !data || !data.factors) return;
    const f = data.factors; const score = data.score || 0; let summary = "";
    if (score >= 60) summary += `ç›®å‰æ™¯æ°£è™•æ–¼ <span class="highlight">å¼·å‹æˆé•·æœŸ (Growth)</span>ï¼ŒåŸºæœ¬é¢æ•¸æ“šç©©å¥ã€‚`;
    else if (score >= 40) summary += `ç›®å‰æ™¯æ°£è™•æ–¼ <span class="highlight">éœ‡ç›ªèª¿æ•´æœŸ</span>ï¼Œå¤šç©ºåŠ›é“æ‹‰é‹¸ã€‚`;
    else summary += `ç›®å‰æ™¯æ°£é¢è‡¨ <span class="warn">ä¿®æ­£é¢¨éšª (Slowdown/Recession)</span>ï¼ŒåŸºæœ¬é¢å‹•èƒ½è½‰å¼±ã€‚`;

    const isLiquidityStrong = (f.liquidity?.score >= 12); const isCreditStrong = (f.credit?.score >= 12);
    if (isLiquidityStrong && isCreditStrong) summary += `å—æƒ æ–¼ <span class="highlight">è³‡é‡‘å……æ²›</span> èˆ‡ä¿¡ç”¨é¢¨éšªåå¥½ç¶­æŒé«˜æª”ï¼Œå¸‚å ´å…·å‚™ã€Œè³‡é‡‘è¡Œæƒ…ã€æ”¯æ’ã€‚`;
    else if (!isLiquidityStrong && isCreditStrong) summary += `é›–ç„¶ä¿¡ç”¨åˆ©å·®ç©©å®šï¼Œä½†è³‡é‡‘æ°´ä½æ­£åœ¨ä¸‹é™ï¼Œéœ€ç•™æ„å‹•èƒ½å»¶çºŒæ€§ã€‚`;
    else if (!isCreditStrong) summary += `ä¸”ä¿¡ç”¨åˆ©å·®æ“´å¤§ï¼Œé¡¯ç¤ºå¸‚å ´é¿éšªæƒ…ç·’æ­£åœ¨å‡æº«ï¼Œéœ€æé«˜è­¦è¦ºã€‚`;
    
    summary += `<br><br><strong>âœ¦ æ“ä½œå»ºè­°ï¼š</strong>`;
    if (score >= 60 && isLiquidityStrong) summary += `é †å‹¢æ“ä½œã€‚å› æµå‹•æ€§å¼·å‹ï¼Œ<span class="highlight">ç§‘æŠ€è‚¡ã€æˆé•·è‚¡èˆ‡åŠ å¯†è²¨å¹£</span> è¡¨ç¾å°‡å„ªæ–¼é˜²ç¦¦å‹è³‡ç”¢ã€‚ä½†éœ€ç•™æ„ Equity åˆ†æ•¸è‹¥éé«˜ï¼Œåˆ‡å‹¿éåº¦è¿½åƒ¹ï¼Œå»ºè­°é€¢å›å¸ƒå±€ã€‚`;
    else if (score >= 60 && !isLiquidityStrong) summary += `å›æ­¸åŸºæœ¬é¢ã€‚è³‡é‡‘æ½®é€€å»ï¼Œé¸è‚¡å°‡é‡æ–¼é¸å¸‚ï¼Œèšç„¦ <span class="highlight">é«˜ EPS æˆé•·</span> ä¹‹å¯¦è³ªæ¥­ç¸¾è‚¡ï¼Œé¿é–‹ç„¡åŸºä¹‹å½ˆçš„æŠ•æ©Ÿæ¨™çš„ã€‚`;
    else if (score < 40) summary += `é˜²ç¦¦ç‚ºä¸»ã€‚å»ºè­°æ‹‰é«˜ <span class="highlight">ç¾é‡‘èˆ‡æŠ•è³‡ç´šå‚µ (IG Bond)</span> éƒ¨ä½ï¼Œé™ä½è‚¡ç¥¨æ›éšªï¼Œç›´è‡³ MACRO æŒ‡æ¨™è½åº•å›å‡ã€‚`;
    else summary += `å€é–“æ“ä½œã€‚å¸‚å ´ç¼ºä¹æ˜ç¢ºæ–¹å‘ï¼Œå»ºè­°æ¡å– <span class="highlight">è‚¡å‚µå¹³è¡¡</span> é…ç½®ï¼Œä¸¦é€éç¶²æ ¼äº¤æ˜“æˆ–å®šæœŸå®šé¡åˆ†æ•£æ³¢å‹•é¢¨éšªã€‚`;
    el.innerHTML = summary;
  }

  function updateMcsGauge(score, stage) {
    const canvas = document.getElementById('mcsGaugeChart');
    const centerText = document.getElementById('gaugeScoreText');
    if(!canvas || !centerText) return;
    centerText.textContent = (score == null || Number.isNaN(score)) ? '--' : Math.round(score);
    const labels = ['Recession','Slowdown','Growth','Heat'];
    const bgColors = ['rgba(248,113,113,0.22)','rgba(251,146,60,0.20)','rgba(34,197,94,0.18)','rgba(234,179,8,0.16)'];
    const activeColors = { Recession:'rgba(248,113,113,0.9)', Slowdown:'rgba(251,146,60,0.9)', Growth:'rgba(34,197,94,0.9)', Heat:'rgba(234,179,8,0.9)' };
    const baseColorsMap = { Recession:bgColors[0], Slowdown:bgColors[1], Growth:bgColors[2], Heat:bgColors[3] };
    const finalBg = labels.map(s => (stage && s===stage) ? activeColors[s] : baseColorsMap[s]);
    const finalBorder = labels.map(s => (stage && s===stage) ? 'rgba(15,23,42,1)' : 'rgba(15,23,42,0.6)');
    const ctx = canvas.getContext('2d');
    if (!gaugeChart) {
      gaugeChart = new Chart(ctx, {
        type: 'doughnut',
        data: { labels, datasets: [{ data: [25,25,25,25], backgroundColor: finalBg, borderColor: finalBorder, borderWidth: 1.5, hoverOffset: 2 }] },
        options: { responsive: true, cutout: '70%', plugins: { legend: { display: false }, tooltip: { enabled:false } } }
      });
    } else {
      gaugeChart.data.datasets[0].backgroundColor = finalBg;
      gaugeChart.data.datasets[0].borderColor = finalBorder;
      gaugeChart.update();
    }
  }

  async function loadMcs(profile = 'balanced') {
    try {
      let data = {}; let isFallback = false;
      const sourceEl = document.getElementById('mcsSource');
      const asOfEl = document.getElementById('mcsAsOf');
      try {
        const res  = await fetch(`${API_BASE}/api/mcs/allocation?profile=${profile}`, { cache:'no-store' });
        if (!res.ok) throw new Error('API error');
        data = await res.json();
        if(sourceEl) { sourceEl.textContent = 'SOURCE: ' + (data.raw?.source || 'FRED'); sourceEl.style.cssText = "background:rgba(255,255,255,0.08);color:var(--muted);border:none;"; }
      } catch(e) {
        isFallback = true;
        if(sourceEl) { sourceEl.innerHTML = 'âš  é€£ç·šå¤±æ•— (é¡¯ç¤ºæ¨¡æ“¬æ•¸æ“š)'; sourceEl.style.cssText = "background:rgba(220,38,38,0.2);color:#fca5a5;border:1px solid #ef4444;font-weight:bold;"; }
        data = { score: 66, stage: 'Growth', asOf: new Date().toISOString().slice(0,10), factors: {} };
      }
      if (!data.factors) data.factors = {};
      // æ¨¡æ“¬æ•¸æ“šè£œå…¨ (ç‚ºäº†è®“ AI ç¸½çµæ–‡å­—èƒ½æ­£å¸¸ç”Ÿæˆ)
      if(!data.factors.macro) data.factors.macro = { score: 12, pmi: 47.2, claims: 230000, change: -0.5 };
      if(!data.factors.liquidity) data.factors.liquidity = { score: 16, change: 1.5, net_liq: 6.35, net_liq_note: "è³‡é‡‘å¯¬é¬†", cu_au: 4.15, cu_au_note: "æº«å’Œå¾©ç”¦" };
      if(!data.factors.credit) data.factors.credit = { score: 18, change: 1.2, hy_spread: 3.17, ig_spread: 0.84 };

      if(asOfEl) asOfEl.textContent = 'æ›´æ–°ï¼š' + (data.asOf || '--');
      setStagePill(data.stage);
      updateMcsGauge(data.score, data.stage);
      updateAiSummary(data);
    } catch (err) { console.error(err); }
  }

  function boot(){
    initSEO();
    document.querySelectorAll('.block').forEach(mountBlock);
    restore(); fromURL(); bindEvents(); update();
    // MCS Init
    loadMcs('balanced');
  }
  document.readyState==='loading' ? document.addEventListener('DOMContentLoaded', boot) : boot();
  </script>

  <script src="./assets/tools-config.js"></script>
  <script src="./assets/tools-render.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){ if (window.MOMO_TOOLS && typeof MOMO_TOOLS.initHomeSection === 'function') { MOMO_TOOLS.initHomeSection(); } });
  </script>
</body>
</html>
